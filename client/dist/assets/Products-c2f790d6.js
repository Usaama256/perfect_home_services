import{r as p,j as e,a5 as M,a as t,a6 as L,aY as X,aZ as _,a_ as V,a$ as Y,B as P,g as q,c as E,a7 as Z,aW as J,I as D,T as W,aB as K,E as G,h as j,S as v,X as O,aL as B,s as Q,M as $,D as S,G as ee,b as z}from"./index-559316ce.js";import{d as ie,a as re}from"./KeyboardArrowUp-bd074b9b.js";import{D as R}from"./Delete-b4e49272.js";import{T as te}from"./TableContainer-97b8cfb5.js";import{T as H,a as ae,b as k,c as u,d as ne}from"./TableRow-2f33760f.js";import{E as le,A as se}from"./Edit-d10f50ea.js";import{C as x}from"./Card-2c90ac9f.js";import{i as oe}from"./base64ImgConverter-9cb29916.js";import{C as ce,a as de}from"./CardHeader-648a1719.js";import{C as me}from"./CardContent-e3b9abf5.js";import{G as y}from"./Grid2-0add4141.js";import{T as w}from"./TextField-d3365dcc.js";import{F as ge,I as ue,S as he}from"./Select-3d2ee0e4.js";import{C as T}from"./CameraAlt-dc308bca.js";import{S as pe}from"./SpAccountSuspended-b03ad7ca.js";import{C as fe}from"./Container-49e24797.js";import{G as A}from"./Grid-2fa76f59.js";import"./useFormControl-ad3eb840.js";const be=p.forwardRef(function(a,n){return e(M,{direction:"up",ref:n,...a})}),ye=({open:r,setOpen:a,data:n,deleteFn:l})=>{const c=()=>{a(!1)};return e("div",{children:t(L,{open:r,TransitionComponent:be,keepMounted:!0,onClose:c,"aria-describedby":"alert-dialog-slide-description",children:[e(X,{children:"Confirm Product Delete"}),e(_,{children:t(V,{id:"alert-dialog-slide-description",children:["Product/Service: ",n.name,e("br",{}),"Price: ",n.price?`${n.currency?n.currency:""} ${n.price}`:"NA",e("br",{}),"Description: ",n.desc?n.desc:"NA"]})}),t(Y,{children:[e(P,{onClick:c,variant:"outlined",color:"primary",children:"Cancel"}),e(P,{variant:"contained",color:"error",endIcon:e(R,{}),onClick:()=>{l(n.id),c()},children:"Delete Item"})]})]})})},ve={overflow:"hidden",boxShadow:"0px 2px 5px #0000008e",marginBottom:"20px",display:"flex",alignItems:"center",justifyContent:"center",height:320,width:320},xe=({row:r,isFetching:a,deletePdt:n})=>{var g,i,f;const{enqueueSnackbar:l}=q(),[c,d]=p.useState(!1),[h,m]=p.useState(!1);return t(J.Fragment,{children:[h&&e(ye,{open:h,setOpen:m,data:r,deleteFn:n}),t(k,{sx:{"& > *":{borderBottom:"unset"}},children:[e(u,{children:e(D,{"aria-label":"expand row",size:"small",onClick:()=>d(!c),children:c?e(ie,{}):e(re,{})})}),e(u,{component:"th",scope:"row",children:r.name?r.name:"N/A"}),e(u,{align:"left",children:r.price?`${r.currency?r.currency:""} ${r.price}`:"N/A"}),e(u,{align:"left",children:r.desc?`${((g=r.desc)==null?void 0:g.length)>199?(i=r.desc)==null?void 0:i.subString(0,199):r.desc}`:"N/A"}),t(u,{align:"right",children:[e(W,{title:"Edit Product/Service",arrow:!0,children:e(D,{color:"primary",size:"large",disabled:a,onClick:()=>l("Our Engineers Are Working On It",{variant:"info"}),children:e(le,{})})}),"  ",e(W,{title:"Delete Product/Service",arrow:!0,children:e(D,{color:"error",size:"large",disabled:a,onClick:()=>m(!0),children:e(R,{})})})]})]}),e(k,{children:e(u,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:e(K,{in:c,timeout:"auto",unmountOnExit:!0,children:t(G,{sx:{margin:1},children:[e("br",{}),e(j,{variant:"h6",gutterBottom:!0,component:"div",children:"Images"}),e("br",{}),t(H,{size:"small","aria-label":"purchases",children:[e(v,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:3,sx:{width:"100%"},children:(f=r.images)==null?void 0:f.map((b,C)=>t(v,{direction:"column",alignItems:"center",justifyContent:"center",spacing:3,children:[e(x,{style:ve,children:b&&e("img",{src:b,alt:"img",style:{width:"100%",height:"100%",objectFit:"cover"}})}),t(j,{variant:"body1",children:["Image ",C+1]})]},C))}),e("br",{})]})]})})})})]})},Ce=({products:r,SPid:a})=>{const{enqueueSnackbar:n}=q(),l=E(),[c,d]=p.useState(!1),h=async m=>{var g;try{n("Please Wait While Deleting Product",{variant:"info"}),d(!0),(await O.get(`/sp.api/deletePdt/${a}/${m}`)).status===200?(n("Product Deleted Successfully",{variant:"success"}),B(l)):n("Error: Deleting Failed",{variant:"error"})}catch(i){n("Error: Deleting Failed",{variant:"error"}),n((g=i.response)==null?void 0:g.data,{variant:"error"}),console.log(i),i.response?console.log(i.response,i.message):i.request?i.request.status?console.error(i.message,i.request):console.log(i.request,i.message):console.log(i.message)}finally{d(!1)}};return e(te,{component:Z,children:t(H,{"aria-label":"collapsible table",children:[e(ae,{children:t(k,{children:[e(u,{}),e(u,{children:"Item/Product/Service"}),e(u,{align:"left",children:"Price"}),e(u,{align:"left",children:"Description"}),e(u,{align:"right",children:"Actions"})]})}),e(ne,{children:r==null?void 0:r.map((m,g)=>e(xe,{row:m,isFetching:c,deletePdt:h},g))})]})})},U={overflow:"hidden",boxShadow:"0px 2px 5px #0000008e",display:"flex",alignItems:"center",justifyContent:"center",height:320,width:320},Se=({SPid:r})=>{const{enqueueSnackbar:a}=q(),n=E(),[l,c]=p.useState(!1),[d,h]=p.useState({name:"",price:"",desc:"",currency:""}),[m,g]=p.useState(!1),[i,f]=p.useState({img1:"",img2:"",img3:""}),b=(s,o)=>{s.target.files.length!==0&&(g(!0),a("Please Wait While Uploading Images",{variant:"info"}),oe(s.target.files[0]).then(I=>{o===1?(f({...i,img1:I}),g(!1),a("Image 1 Uploaded Successfully",{variant:"success"})):o===2?(f({...i,img2:I}),g(!1),a("Image 1 Uploaded Successfully",{variant:"success"})):o===3&&(f({...i,img3:I}),g(!1),a("Image 1 Uploaded Successfully",{variant:"success"}))})),s.target.value=null},C=async()=>{var s;if(m===!0)a("Please Wait While Uploading Images",{variant:"info"});else if(d.name.length<2)a("Enter A Valid Product/Service Name",{variant:"error"});else try{a("Please wait while adding the New Product",{variant:"info"}),c(!0),(await O.post(`/sp.api/addPdt/${r}`,{...d,imgsArr:[i.img1?i.img1:"",i.img2?i.img2:"",i.img3?i.img3:""]})).status===200?(a("Product/Service Added Successfully",{variant:"success"}),N(),B(n)):a("Error: Product/Service Not Added",{variant:"error"})}catch(o){a("Error: Product/Service Not Added",{variant:"error"}),a((s=o.response)==null?void 0:s.data,{variant:"error"}),console.log(o),o.response?console.log(o.response,o.message):o.request?o.request.status?console.error(o.message,o.request):console.log(o.request,o.message):console.log(o.message)}finally{c(!1)}},N=()=>{h({name:"",price:"",desc:"",currency:"",imagesArr:[]}),f({img1:"",img2:"",img3:""})};return t(x,{children:[e(ce,{title:"Add Product / Service"}),e(me,{sx:{pt:0},children:e(G,{sx:{margin:"20px 0px 10px 0px"},children:t(y,{container:!0,spacing:3,columns:12,children:[e(y,{item:!0,xs:12,md:6,children:e(w,{fullWidth:!0,label:"Product/Service Name",required:!0,value:d.name,onChange:s=>h({...d,name:s.target.value}),disabled:l})}),e(y,{item:!0,xs:12,md:3,children:e(w,{fullWidth:!0,label:"Price",value:d.price,onChange:s=>h({...d,price:s.target.value}),disabled:l})}),e(y,{item:!0,xs:12,md:3,children:t(ge,{sx:{m:1,width:"100%",margin:"0px 0px",flex:1},size:"large",children:[e(ue,{id:"select-small",children:"Currency"}),t(he,{labelId:"select-small",id:"select-small",value:d.currency,label:"currency",onChange:s=>h({...d,currency:s.target.value}),disabled:l,children:[e($,{value:"UGX",children:" UGX"}),e($,{value:"USD",children:"USD"})]})]})}),e(y,{item:!0,xs:12,md:12,children:e(w,{fullWidth:!0,label:"Description",helperText:"Not More than 100 words",multiline:!0,rows:4,required:!0,value:d.desc,onChange:s=>h({...d,desc:s.target.value}),disabled:l})}),e(y,{item:!0,xs:12,md:12,children:t(v,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:3,sx:{width:"100%"},children:[t(v,{direction:"column",alignItems:"center",justifyContent:"center",gap:1,children:[e(x,{style:U,children:i.img1&&e("img",{src:i.img1,alt:"img",style:{width:"100%",height:"100%",objectFit:"cover"}})}),e("input",{style:{display:"none"},type:"file",id:"img1Upload",disabled:l||m,name:"imageUpload",accept:"image/*",onChange:s=>b(s,1)}),e("label",{htmlFor:"img1Upload",disabled:l||m,children:t(F,{children:["Upload Image One",e(S,{size:"large",children:e(T,{})})]})})]}),t(v,{direction:"column",alignItems:"center",justifyContent:"center",gap:1,children:[e(x,{style:U,children:i.img2&&e("img",{src:i.img2,alt:"img",style:{width:"100%",height:"100%",objectFit:"cover"}})}),e("input",{style:{display:"none"},type:"file",id:"img2Upload",disabled:l||m||i.img1.length===0,name:"imageUpload",accept:"image/*",onChange:s=>b(s,2)}),e("label",{htmlFor:"img2Upload",disabled:l||m||i.img1.length===0,children:t(F,{children:["Upload Image Two",e(S,{size:"large",children:e(T,{})})]})})]}),t(v,{direction:"column",alignItems:"center",justifyContent:"center",gap:1,children:[e(x,{style:U,children:i.img3&&e("img",{src:i.img3,alt:"img",style:{width:"100%",height:"100%",objectFit:"cover"}})}),e("input",{style:{display:"none"},type:"file",id:"img3Upload",disabled:l||m||i.img2.length===0,name:"imageUpload",accept:"image/*",onChange:s=>b(s,3)}),e("label",{htmlFor:"img3Upload",disabled:l||m||i.img2.length===0,children:t(F,{children:["Upload Image Three",e(S,{size:"large",children:e(T,{})})]})})]})]})})]})})}),e(ee,{}),t(de,{sx:{justifyContent:"flex-end"},children:[e(P,{variant:"outlined",color:"secondary",disabled:l,onClick:()=>N(),children:"Reset Fields"}),e(P,{variant:"contained",color:"primary",endIcon:e(S,{size:"small",children:e(se,{})}),disabled:l,onClick:()=>C(),children:"Add"})]})]})},F=Q.div`
  margin: 10px 10px;
  padding: 10px 10px;
  font-size: 1rem;
  font-weight: 700;
  transition: all 0.3s linear;
  background-color: rgba(0, 0, 0, 0);
  border: 0.5px solid #2064d17c;
  color: #2065d1;
  cursor: pointer;
  border-radius: 8px;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 8px;
  /* text-transform: uppercase; */

  &:hover {
    background-color: #2064d114;
    border: 1px solid #114fb2;
  }
`,Oe=()=>{const{user:r}=z(c=>c.user),{products:a}=z(c=>c.spData),n=E(),l=r.status==="active";return p.useEffect(()=>{B(r.id,n)},[]),t(fe,{maxWidth:"xl",children:[e(j,{variant:"h4",sx:{mb:5},children:"Products / Services"}),l===!1&&e(pe,{}),t(A,{container:!0,spacing:3,children:[e(A,{item:!0,xs:12,md:12,lg:12,children:e(Ce,{products:a,SPid:r.id})}),e(A,{item:!0,xs:12,md:12,lg:12,children:e(Se,{SPid:r.id})})]})]})};export{Oe as default};
